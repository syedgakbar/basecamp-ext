function enableOptions(a){$(".BceOption").attr("disabled",a?"":"disabled")}function populateLastFiveYears(a){var b=(new Date).getFullYear()-4;for(i=0;i<5;i++)a.options[a.length]=new Option(b+i,b+i)}
function SavePreferences(a){if(a=="TimeEntry"){BasecampExt.Preferences.Disabled=!$("#chExtEnabled")[0].checked;BasecampExt.Preferences.TimeEntry.DefaultPerson=$("#txtDefaultPerson").val();BasecampExt.Preferences.TimeEntry.DescriptionStripString=$("#txtDescriptionPrefix").val();BasecampExt.Preferences.TimeEntry.ParseTimeFromDescription=$("#chkParseTimeFromDesc")[0].checked;BasecampExt.Preferences.TimeEntry.SetLastChangeDateAsDefault=$("#chkSetLastDateAsDefault")[0].checked;BasecampExt.Preferences.TimeEntry.DefaultDate.Day=
$("#drpDefaultDateDay").val();BasecampExt.Preferences.TimeEntry.DefaultDate.Month=$("#drpDefaultDateMonth").val();BasecampExt.Preferences.TimeEntry.DefaultDate.Year=$("#drpDefaultDateYear").val()}if(a=="TimeGraph")BasecampExt.Preferences.TimeGraph.Enabled=$("#chkShowCreateGraphLink")[0].checked;if(a=="OptionsViewState"){BasecampExt.Preferences.Options.TimeEntryIsVisible=$("#divTimeEntryOptions").is(":visible");BasecampExt.Preferences.Options.TimeGraphIsVisible=$("#divTimeGraphOptions").is(":visible")}BasecampExt.SavePreferences()}
function PopulatePreferences(){BasecampExt.Browser.WaitAsynchSecure(function(){return BasecampExt&&BasecampExt.PreferencesLoaded},function(){$("#chExtEnabled")[0].checked=!BasecampExt.Preferences.Disabled;$("#txtDefaultPerson").val(BasecampExt.Preferences.TimeEntry.DefaultPerson);$("#txtDescriptionPrefix").val(BasecampExt.Preferences.TimeEntry.DescriptionStripString);$("#chkParseTimeFromDesc")[0].checked=BasecampExt.Preferences.TimeEntry.ParseTimeFromDescription;$("#chkSetLastDateAsDefault")[0].checked=
BasecampExt.Preferences.TimeEntry.SetLastChangeDateAsDefault;populateLastFiveYears($("#drpDefaultDateYear")[0]);$("#drpDefaultDateDay").val(BasecampExt.Preferences.TimeEntry.DefaultDate.Day);$("#drpDefaultDateMonth").val(BasecampExt.Preferences.TimeEntry.DefaultDate.Month);$("#drpDefaultDateYear").val(BasecampExt.Preferences.TimeEntry.DefaultDate.Year);$("#chkShowCreateGraphLink")[0].checked=BasecampExt.Preferences.TimeGraph.Enabled;enableOptions(!BasecampExt.Preferences.Disabled);BasecampExt.Preferences.Options.TimeEntryIsVisible?
$("#divTimeEntryOptions").show():$("#divTimeEntryOptions").hide();BasecampExt.Preferences.Options.TimeGraphIsVisible?$("#divTimeGraphOptions").show():$("#divTimeGraphOptions").hide()})}
jQuery(document).ready(function(){$("#options_wrapper .section_header").click(function(){var a=$(this).next();a.is(":visible")?a.slideUp(400,function(){SavePreferences("OptionsViewState")}):a.slideDown(200,function(){SavePreferences("OptionsViewState")})});PopulatePreferences();$("#chExtEnabled").bind("click",function(){enableOptions(this.checked);SavePreferences("TimeEntry")});$("#drpDefaultDateMonth").bind("change",function(){SavePreferences("TimeEntry")});$("#drpDefaultDateDay").bind("change",
function(){SavePreferences("TimeEntry")});$("#drpDefaultDateYear").bind("change",function(){SavePreferences("TimeEntry")});$("#txtDefaultPerson").bind("change",function(){SavePreferences("TimeEntry")});$("#txtDescriptionPrefix").bind("change",function(){SavePreferences("TimeEntry")});$("#chkParseTimeFromDesc").bind("click",function(){SavePreferences("TimeEntry")});$("#chkSetLastDateAsDefault").bind("click",function(){SavePreferences("TimeEntry")});$("#chkShowCreateGraphLink").bind("click",function(){SavePreferences("TimeGraph")})});
